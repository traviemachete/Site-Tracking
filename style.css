/* ====== style.css (responsive) ====== */
html, body { height: 100%; margin: 0; font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif; }
#map { height: 100%; width: 100%; }

/* การ์ดมาตรฐาน */
.card{ background:#fff; border:1px solid #ddd; border-radius:10px; padding:12px 14px; box-shadow:0 4px 12px rgba(0,0,0,.12); }

/* กองด้านขวา (จอใหญ่) */
.side-stack{
  position:absolute; top:14px; right:14px; z-index:1000;
  display:flex; flex-direction:column; gap:12px; max-width:420px;
  transition: transform .25s ease, opacity .25s ease;
}
.side-stack.hidden{ transform:translateX(calc(100% + 16px)); opacity:0; pointer-events:none; }

/* ปุ่มซ่อน/แสดง (จอใหญ่) */
.stack-toggle{
  position:absolute; top:14px; right:14px; z-index:1001;
  width:28px; height:28px; border-radius:14px; border:1px solid #d0d5dd; background:#fff;
  box-shadow:0 2px 8px rgba(0,0,0,.12); cursor:pointer; font-weight:700;
  display:grid; place-items:center; transition:transform .25s ease;
}
.side-stack.hidden ~ .stack-toggle{ transform:rotate(180deg); }

/* ฟิลเตอร์ */
.filter-row{ display:grid; grid-template-columns:1fr 1fr; gap:8px 10px; }
.filter-row label{ display:flex; flex-direction:column; gap:6px; font-weight:600; }
.filter-row select{ padding:6px 8px; border:1px solid #d0d5dd; border-radius:8px; background:#fff; font-size:13px; }
.filter-actions{ display:flex; justify-content:space-between; align-items:center; gap:8px; margin-top:10px; }
#btn-reset{ padding:6px 10px; border:1px solid #d0d5dd; border-radius:8px; background:#f7f7f7; cursor:pointer; font-weight:600; }
#btn-reset:hover{ background:#efefef; }
.count{ font-weight:600; }

/* สรุป */
.stats-header{ font-weight:800; margin-bottom:8px; }
.stats-grid{ display:grid; grid-template-columns:1fr 1fr 1fr; gap:10px; margin-bottom:10px; }
.stats-grid.two{ grid-template-columns:1fr 1fr; }
.stat{ background:#f8fafc; border:1px solid #e5e7eb; border-radius:8px; padding:8px 10px; text-align:center; }
.stat-label{ color:#475569; font-weight:700; }
.stat-value{ font-size:20px; font-weight:900; margin-top:4px; }
.stats-subheader{ font-weight:800; margin:8px 0 6px; }

/* ตาราง Type */
.type-table{ width:100%; border-collapse:collapse; font-size:12.5px; }
.type-table th, .type-table td{ padding:6px 8px; border-bottom:1px solid #eee; }
.type-table th{ text-align:left; color:#475569; }
.type-table .th-right{ text-align:right; }
.type-table td:last-child{ text-align:right; font-weight:700; }

/* Legend */
.legend{
  position:absolute; bottom:14px; left:14px; z-index:999;
  background:#fff; padding:8px 10px; border:1px solid #ddd; border-radius:6px;
  font-size:12px; line-height:1.4; box-shadow:0 2px 6px rgba(0,0,0,.1);
}
.legend .dot{ display:inline-block; width:10px; height:10px; border-radius:50%; margin-right:6px; vertical-align:middle; }

/* ---------- Breakpoints ---------- */

/* แท็บเล็ตแนวตั้ง / iPad (≤ 1024px) */
@media (max-width: 1024px){
  .side-stack{ max-width: 360px; }
}


/* มือถือ / จอเล็ก (≤ 768px) → แปลงเป็นลิ้นชักล่าง */
@media (max-width: 768px){
  /* side-stack = bottom sheet (ไม่บังเต็มจอ, เลื่อนอ่านได้) */
  .side-stack{
    position: fixed;
    left: 12px;
    right: 12px;
    bottom: calc(12px + env(safe-area-inset-bottom)); /* เคารพ safe area iPhone */
    top: auto;
    max-height: 70vh;              /* สูงสุด 70% ของหน้าจอ */
    overflow: auto;                /* ข้างในเลื่อนได้ */
    border-radius: 14px;
    gap: 10px;
    transform: translateY(0);      /* โผล่อยู่เหนือขอบล่าง */
    box-shadow: 0 10px 24px rgba(0,0,0,.18);
  }
  /* ซ่อนแบบเลื่อนลงล่าง + เคารพ safe area */
  .side-stack.hidden{
    transform: translateY(calc(100% + 24px + env(safe-area-inset-bottom)));
    opacity: 1;
    pointer-events: none;
  }

  /* ปุ่ม ▸ ย้ายไปมุมขวาล่าง และเคารพ safe area */
  .stack-toggle{
    position: fixed;
    bottom: calc(12px + env(safe-area-inset-bottom));
    right: 12px;
    width: 38px; height: 38px; border-radius: 19px; font-size: 18px;
  }
  .side-stack.hidden ~ .stack-toggle{ transform: rotate(90deg); } /* ชี้ขึ้นตอนซ่อน */

  /* ฟิลเตอร์เป็นคอลัมน์เดียว + ปุ่ม/ตัวหนังสือใหญ่ขึ้นอ่านง่าย */
  .filter-row{ grid-template-columns: 1fr; }
  .filter-row select{ padding: 10px 12px; font-size: 15px; }
  .filter-actions{ flex-direction: column; align-items: stretch; gap: 8px; }
  .count{ text-align: center; }

  /* ตาราง Type เลื่อนได้แนวนอน */
  .type-table{ display: block; overflow-x: auto; -webkit-overflow-scrolling: touch; }
  .type-table table{ min-width: 360px; }

  /* เลื่อน legend ขึ้นเล็กน้อยกันชนขอบล่าง */
  .legend{
    bottom: calc(60px + env(safe-area-inset-bottom));
  }
}

/* แท็บเล็ตแนวตั้ง / iPad (≤ 1024px) – บีบความกว้างแผงลงหน่อย */
@media (max-width: 1024px){
  .side-stack{ max-width: 360px; }
}

/* ป้องกันอาการลากทั้งหน้าเวลาเลื่อนลิ้นชักบน iOS */
html, body{
  overscroll-behavior-y: contain;
}
